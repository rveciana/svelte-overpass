var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function r(t){return"function"==typeof t}function i(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function a(t,n){t.appendChild(n)}function s(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function u(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function l(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}let h,d;function f(){if(void 0===h){h=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){h=!0}}return h}function p(t){d=t}function g(t){(function(){if(!d)throw new Error("Function called outside component initialization");return d})().$$.on_mount.push(t)}const m=[],w=[],v=[],$=[],b=Promise.resolve();let M=!1;function y(t){v.push(t)}let x=!1;const _=new Set;function k(){if(!x){x=!0;do{for(let t=0;t<m.length;t+=1){const n=m[t];p(n),E(n.$$)}for(p(null),m.length=0;w.length;)w.pop()();for(let t=0;t<v.length;t+=1){const n=v[t];_.has(n)||(_.add(n),n())}v.length=0}while(m.length);for(;$.length;)$.pop()();M=!1,x=!1,_.clear()}}function E(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(y)}}const P=new Set;function T(t,n){-1===t.$$.dirty[0]&&(m.push(t),M||(M=!0,b.then(k)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function A(i,a,c,u,l,h,f=[-1]){const g=d;p(i);const m=a.props||{},w=i.$$={fragment:null,ctx:null,props:h,update:t,not_equal:l,bound:e(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(g?g.$$.context:[]),callbacks:e(),dirty:f,skip_bound:!1};let v=!1;if(w.ctx=c?c(i,m,((t,n,...e)=>{const o=e.length?e[0]:n;return w.ctx&&l(w.ctx[t],w.ctx[t]=o)&&(!w.skip_bound&&w.bound[t]&&w.bound[t](o),v&&T(i,t)),n})):[],w.update(),v=!0,o(w.before_update),w.fragment=!!u&&u(w.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);w.fragment&&w.fragment.l(t),t.forEach(s)}else w.fragment&&w.fragment.c();a.intro&&(($=i.$$.fragment)&&$.i&&(P.delete($),$.i(b))),function(t,e,i){const{fragment:a,on_mount:s,on_destroy:c,after_update:u}=t.$$;a&&a.m(e,i),y((()=>{const e=s.map(n).filter(r);c?c.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(y)}(i,a.target,a.anchor),k()}var $,b;p(g)}var I=.9996,N=.00669438,z=Math.pow(N,2),S=Math.pow(N,3),W=N/(1-N),C=1-N/4-3*z/64-5*S/256,O=3*N/8+3*z/32+45*S/1024,j=15*z/256+45*S/1024,q=35*S/3072,L=6378137,R="CDEFGHJKLMNPQRSTUVWXX";function X(t,n,e){if(t>84||t<-80)throw new RangeError("latitude out of range (must be between 80 deg S and 84 deg N)");if(n>180||n<-180)throw new RangeError("longitude out of range (must be between 180 deg W and 180 deg E)");var o,r=B(t),i=Math.sin(r),a=Math.cos(r),s=Math.tan(r),c=Math.pow(s,2),u=Math.pow(s,4);o=void 0===e?function(t,n){if(56<=t&&t<64&&3<=n&&n<12)return 32;if(72<=t&&t<=84&&n>=0){if(n<9)return 31;if(n<21)return 33;if(n<33)return 35;if(n<42)return 37}return Math.floor((n+180)/6)+1}(t,n):e;var l=function(t){return-80<=t&&t<=84?R[Math.floor((t+80)/8)]:null}(t),h=B(n),d=B(function(t){return 6*(t-1)-180+3}(o)),f=L/Math.sqrt(1-N*i*i),p=W*a*a,g=a*(h-d),m=Math.pow(g,2),w=Math.pow(g,3),v=Math.pow(g,4),$=Math.pow(g,5),b=Math.pow(g,6),M=L*(C*r-O*Math.sin(2*r)+j*Math.sin(4*r)-q*Math.sin(6*r)),y=I*(M+f*s*(m/2+v/24*(5-c+9*p+4*p*p)+b/720*(61-58*c+u+600*p-330*W)));return t<0&&(y+=1e7),{easting:I*f*(g+w/6*(1-c+p)+$/120*(5-18*c+u+72*p-58*W))+5e5,northing:y,zoneNum:o,zoneLetter:l}}function B(t){return t*Math.PI/180}const F=(t,n,e)=>{var o,r;if(!t)return;t.clearRect(0,0,t.canvas.width,t.canvas.height),t.rect(0,0,t.canvas.width,t.canvas.height),t.stroke(),D(t,e),t.save(),t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor="black",t.shadowBlur=4,t.strokeStyle="gray",t.fillStyle="blanchedalmond",t.textAlign="center",t.lineWidth=4,t.translate(t.canvas.width/2,t.canvas.height/2);const i=(null===(o=n[0])||void 0===o?void 0:o.dist)||0,a=(null===(r=n[9])||void 0===r?void 0:r.dist)||0;n.forEach(((n,o)=>{if(o<=10){const o=-Math.PI/2+Math.PI*(n.dir-e)/180,s=(r=n.dist,t.canvas.width/4+t.canvas.width/5*(r-i)/(a-i));t.strokeText(n.name,s*Math.cos(o),s*Math.sin(o)),t.fillText(n.name,s*Math.cos(o),s*Math.sin(o))}var r})),t.rotate(Math.PI/2),t.restore()},D=(t,n)=>{const e=t.canvas.width/2,o=t.canvas.height/2;t.save(),t.translate(e,o),t.rotate(-Math.PI*n/180),t.font="14px Arial";const r=["N","E","S","W"];for(let n=0;n<4;n++)t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.lineTo(-e/12,-o/12),t.lineTo(0,0),t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.lineTo(e/12,-o/12),t.lineTo(0,0),t.stroke(),t.fillText(r[n],-5,-5-o/2),t.rotate(Math.PI/2);t.restore()};function G(n){let e,o,r;return{c(){e=c("main"),o=c("canvas"),l(o,"width",n[0]),l(o,"height",n[0]),l(e,"class","svelte-1p8fxlt"),y((()=>n[5].call(e)))},m(t,i){!function(t,n,e){t.insertBefore(n,e||null)}(t,e,i),a(e,o),n[4](o),r=function(t,n){"static"===getComputedStyle(t).position&&(t.style.position="relative");const e=c("iframe");e.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1;const o=f();let r;return o?(e.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",r=u(window,"message",(t=>{t.source===e.contentWindow&&n()}))):(e.src="about:blank",e.onload=()=>{r=u(e.contentWindow,"resize",n)}),a(t,e),()=>{(o||r&&e.contentWindow)&&r(),s(e)}}(e,n[5].bind(e))},p(t,[n]){1&n&&l(o,"width",t[0]),1&n&&l(o,"height",t[0])},i:t,o:t,d(t){t&&s(e),n[4](null),r()}}}function H(t,n,e){let o,r,i=0,a=0,s=0,c=[];return g((()=>{e(2,r=o.getContext("2d")),navigator.geolocation?navigator.geolocation.watchPosition((function(t){a=t.coords.longitude,s=t.coords.latitude;const{easting:n,northing:o,zoneNum:r}=X(s,a);fetch(`https://overpass.kumi.systems/api/interpreter?data=[out:json][timeout:25000];node["amenity"="bar"](around:1000,${s},${a});out body;>;out skel qt;`).then((t=>t.json())).then((t=>{e(3,c=t.elements.map((t=>{const{easting:e,northing:r,zoneNum:i}=X(t.lat,t.lon),a=Math.sqrt(Math.pow(e-n,2)+Math.pow(r-o,2)),s=180/Math.PI*Math.atan2((e-n)/a,(r-o)/a);return{name:t.tags.name,lng:t.lon,lat:t.lat,dist:a,dir:s}})).filter((t=>void 0!==t.name)).sort(((t,n)=>t.dist-n.dist)))})).catch((t=>{console.error("There has been a problem with the overpass API:",t)}))})):console.log("NO")})),t.$$.update=()=>{12&t.$$.dirty&&F(r,c,45)},[i,o,r,c,function(t){w[t?"unshift":"push"]((()=>{o=t,e(1,o)}))},function(){i=this.clientWidth,e(0,i)}]}return new class extends class{$destroy(){!function(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),A(this,t,H,G,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
